
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <title>JSON · Introducción a Elm</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="HonKit 5.1.4">
        <meta name="author" content="Evan Czaplicki">
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/@honkit/honkit-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
        <link rel="stylesheet" href="../styles/website.css">
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="random.html" />
    
    
    <link rel="prev" href="http.html" />
    

    </head>
    <body>
        
<div class="book honkit-cloak">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introducción
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../core_language.html">
            
                <a href="../core_language.html">
            
                    
                    Lo esencial del lenguaje
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../architecture/">
            
                <a href="../architecture/">
            
                    
                    Arquitectura Elm
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../architecture/buttons.html">
            
                <a href="../architecture/buttons.html">
            
                    
                    Botones
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../architecture/text_fields.html">
            
                <a href="../architecture/text_fields.html">
            
                    
                    Campos de texto
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../architecture/forms.html">
            
                <a href="../architecture/forms.html">
            
                    
                    Formularios
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../types/">
            
                <a href="../types/">
            
                    
                    Tipos
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../types/reading_types.html">
            
                <a href="../types/reading_types.html">
            
                    
                    Leyendo tipos
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../types/type_aliases.html">
            
                <a href="../types/type_aliases.html">
            
                    
                    Alias de tipo
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../types/custom_types.html">
            
                <a href="../types/custom_types.html">
            
                    
                    Tipos personalizados
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="../types/pattern_matching.html">
            
                <a href="../types/pattern_matching.html">
            
                    
                    Pattern Matching
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../error_handling/">
            
                <a href="../error_handling/">
            
                    
                    Error Handling
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../error_handling/maybe.html">
            
                <a href="../error_handling/maybe.html">
            
                    
                    Maybe
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../error_handling/result.html">
            
                <a href="../error_handling/result.html">
            
                    
                    Result
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="./">
            
                <a href="./">
            
                    
                    Commands and Subscriptions
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="http.html">
            
                <a href="http.html">
            
                    
                    HTTP
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.6.2" data-path="json.html">
            
                <a href="json.html">
            
                    
                    JSON
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="random.html">
            
                <a href="random.html">
            
                    
                    Random
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4" data-path="time.html">
            
                <a href="time.html">
            
                    
                    Time
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../install/">
            
                <a href="../install/">
            
                    
                    Installation
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="../install/editor.html">
            
                <a href="../install/editor.html">
            
                    
                    Code Editor
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="../install/elm.html">
            
                <a href="../install/elm.html">
            
                    
                    Elm
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../interop/">
            
                <a href="../interop/">
            
                    
                    JavaScript Interop
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="../interop/flags.html">
            
                <a href="../interop/flags.html">
            
                    
                    Flags
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="../interop/ports.html">
            
                <a href="../interop/ports.html">
            
                    
                    Ports
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3" data-path="../interop/custom_elements.html">
            
                <a href="../interop/custom_elements.html">
            
                    
                    Custom Elements
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.4" data-path="../interop/limits.html">
            
                <a href="../interop/limits.html">
            
                    
                    Limits
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../webapps/">
            
                <a href="../webapps/">
            
                    
                    Web Apps
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" data-path="../webapps/navigation.html">
            
                <a href="../webapps/navigation.html">
            
                    
                    Navigation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2" data-path="../webapps/url_parsing.html">
            
                <a href="../webapps/url_parsing.html">
            
                    
                    URL Parsing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.3" data-path="../webapps/modules.html">
            
                <a href="../webapps/modules.html">
            
                    
                    Modules
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.4" data-path="../webapps/structure.html">
            
                <a href="../webapps/structure.html">
            
                    
                    Structure
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="../optimization/">
            
                <a href="../optimization/">
            
                    
                    Optimization
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.1" data-path="../optimization/lazy.html">
            
                <a href="../optimization/lazy.html">
            
                    
                    Html.lazy
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.2" data-path="../optimization/keyed.html">
            
                <a href="../optimization/keyed.html">
            
                    
                    Html.keyed
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.3" data-path="../optimization/asset_size.html">
            
                <a href="../optimization/asset_size.html">
            
                    
                    Minification
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="../next_steps.html">
            
                <a href="../next_steps.html">
            
                    
                    Next Steps
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12" >
            
                <span>
            
                    
                    Appendix
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.1" data-path="../appendix/types_as_sets.html">
            
                <a href="../appendix/types_as_sets.html">
            
                    
                    Types as Sets
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.2" data-path="../appendix/types_as_bits.html">
            
                <a href="../appendix/types_as_bits.html">
            
                    
                    Types as Bits
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.3" data-path="../appendix/function_types.html">
            
                <a href="../appendix/function_types.html">
            
                    
                    Function Types
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://github.com/honkit/honkit" target="blank" class="gitbook-link">
            Published with HonKit
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >JSON</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="json">JSON</h1>
<p>We just saw an example that uses HTTP to get the content of a book. That is great, but a ton of servers return data in a special format called JavaScript Object Notation, or JSON for short.</p>
<p>So our next example shows how to fetch some JSON data, allowing us to press a button to show random quotes from a haphazard selection of books. Click the blue "Edit" button and look through the program a bit. Maybe you have read some of these books too? <strong>Click the blue button now!</strong></p>
<div class="edit-link"><a href="https://elm-lang.org/examples/quotes" target="_blank">Edit</a></div>

<pre><code class="lang-elm"><span class="hljs-keyword">import</span> Browser
<span class="hljs-keyword">import</span> Html <span class="hljs-keyword">exposing</span> (..)
<span class="hljs-keyword">import</span> Html.Attributes <span class="hljs-keyword">exposing</span> (style)
<span class="hljs-keyword">import</span> Html.Events <span class="hljs-keyword">exposing</span> (..)
<span class="hljs-keyword">import</span> Http
<span class="hljs-keyword">import</span> Json.Decode <span class="hljs-keyword">exposing</span> (<span class="hljs-type">Decoder</span>, field, int, map4, string)



<span class="hljs-comment">-- MAIN</span>


<span class="hljs-title">main</span> =
    <span class="hljs-type">Browser</span>.element
        { init = init
        , update = update
        , subscriptions = subscriptions
        , view = view
        }



<span class="hljs-comment">-- MODEL</span>


<span class="hljs-keyword">type</span> <span class="hljs-type">Model</span>
    = <span class="hljs-type">Failure</span>
    | <span class="hljs-type">Loading</span>
    | <span class="hljs-type">Success</span> <span class="hljs-type">Quote</span>


<span class="hljs-keyword">type</span> <span class="hljs-keyword">alias</span> <span class="hljs-type">Quote</span> =
    { quote : <span class="hljs-type">String</span>
    , source : <span class="hljs-type">String</span>
    , author : <span class="hljs-type">String</span>
    , year : <span class="hljs-type">Int</span>
    }


<span class="hljs-title">init</span> : () -&gt; ( <span class="hljs-type">Model</span>, <span class="hljs-type">Cmd</span> <span class="hljs-type">Msg</span> )
<span class="hljs-title">init</span> _ =
    ( <span class="hljs-type">Loading</span>, getRandomQuote )



<span class="hljs-comment">-- UPDATE</span>


<span class="hljs-keyword">type</span> <span class="hljs-type">Msg</span>
    = <span class="hljs-type">MorePlease</span>
    | <span class="hljs-type">GotQuote</span> (<span class="hljs-type">Result</span> <span class="hljs-type">Http</span>.<span class="hljs-type">Error</span> <span class="hljs-type">Quote</span>)


<span class="hljs-title">update</span> : <span class="hljs-type">Msg</span> -&gt; <span class="hljs-type">Model</span> -&gt; ( <span class="hljs-type">Model</span>, <span class="hljs-type">Cmd</span> <span class="hljs-type">Msg</span> )
<span class="hljs-title">update</span> msg model =
    <span class="hljs-keyword">case</span> msg <span class="hljs-keyword">of</span>
        <span class="hljs-type">MorePlease</span> -&gt;
            ( <span class="hljs-type">Loading</span>, getRandomQuote )

        <span class="hljs-type">GotQuote</span> result -&gt;
            <span class="hljs-keyword">case</span> result <span class="hljs-keyword">of</span>
                <span class="hljs-type">Ok</span> quote -&gt;
                    ( <span class="hljs-type">Success</span> quote, <span class="hljs-type">Cmd</span>.none )

                <span class="hljs-type">Err</span> _ -&gt;
                    ( <span class="hljs-type">Failure</span>, <span class="hljs-type">Cmd</span>.none )



<span class="hljs-comment">-- SUBSCRIPTIONS</span>


<span class="hljs-title">subscriptions</span> : <span class="hljs-type">Model</span> -&gt; <span class="hljs-type">Sub</span> <span class="hljs-type">Msg</span>
<span class="hljs-title">subscriptions</span> model =
    <span class="hljs-type">Sub</span>.none



<span class="hljs-comment">-- VIEW</span>


<span class="hljs-title">view</span> : <span class="hljs-type">Model</span> -&gt; <span class="hljs-type">Html</span> <span class="hljs-type">Msg</span>
<span class="hljs-title">view</span> model =
    div []
        [ h2 [] [ text <span class="hljs-string">"Random Quotes"</span> ]
        , viewQuote model
        ]


<span class="hljs-title">viewQuote</span> : <span class="hljs-type">Model</span> -&gt; <span class="hljs-type">Html</span> <span class="hljs-type">Msg</span>
<span class="hljs-title">viewQuote</span> model =
    <span class="hljs-keyword">case</span> model <span class="hljs-keyword">of</span>
        <span class="hljs-type">Failure</span> -&gt;
            div []
                [ text <span class="hljs-string">"I could not load a random quote for some reason. "</span>
                , button [ onClick <span class="hljs-type">MorePlease</span> ] [ text <span class="hljs-string">"Try Again!"</span> ]
                ]

        <span class="hljs-type">Loading</span> -&gt;
            text <span class="hljs-string">"Loading..."</span>

        <span class="hljs-type">Success</span> quote -&gt;
            div []
                [ button [ onClick <span class="hljs-type">MorePlease</span>, style <span class="hljs-string">"display"</span> <span class="hljs-string">"block"</span> ] [ text <span class="hljs-string">"More Please!"</span> ]
                , blockquote [] [ text quote.quote ]
                , p [ style <span class="hljs-string">"text-align"</span> <span class="hljs-string">"right"</span> ]
                    [ text <span class="hljs-string">"— "</span>
                    , cite [] [ text quote.source ]
                    , text (<span class="hljs-string">" by "</span> ++ quote.author ++ <span class="hljs-string">" ("</span> ++ <span class="hljs-type">String</span>.fromInt quote.year ++ <span class="hljs-string">")"</span>)
                    ]
                ]



<span class="hljs-comment">-- HTTP</span>


<span class="hljs-title">getRandomQuote</span> : <span class="hljs-type">Cmd</span> <span class="hljs-type">Msg</span>
<span class="hljs-title">getRandomQuote</span> =
    <span class="hljs-type">Http</span>.get
        { url = <span class="hljs-string">"https://elm-lang.org/api/random-quotes"</span>
        , expect = <span class="hljs-type">Http</span>.expectJson <span class="hljs-type">GotQuote</span> quoteDecoder
        }


<span class="hljs-title">quoteDecoder</span> : <span class="hljs-type">Decoder</span> <span class="hljs-type">Quote</span>
<span class="hljs-title">quoteDecoder</span> =
    map4 <span class="hljs-type">Quote</span>
        (field <span class="hljs-string">"quote"</span> string)
        (field <span class="hljs-string">"source"</span> string)
        (field <span class="hljs-string">"author"</span> string)
        (field <span class="hljs-string">"year"</span> int)
</code></pre>
<p>This example is pretty similar to the last one:</p>
<ul>
<li><code>init</code> starts us off in the <code>Loading</code> state, with a command to get a random quote.</li>
<li><code>update</code> handles the <code>GotQuote</code> message for whenever a new quote is available. Whatever happens there, we do not have any additional commands. It also handles the <code>MorePlease</code> message when someone presses the button, issuing a command to get more random quotes.</li>
<li><code>view</code> shows you the quotes!</li>
</ul>
<p>The main difference is in the <code>getRandomCatGif</code> definition. Instead of using <code>Http.expectString</code>, we have switched to <code>Http.expectJson</code>. What is the deal with that?</p>
<h2 id="json">JSON</h2>
<p>When you ask <a href="https://elm-lang.org/api/random-quotes" target="_blank"><code>/api/random-quotes</code></a> for a random quote, the server produces a string of JSON like this:</p>
<pre><code class="lang-json">{
  <span class="hljs-string">"quote"</span>: <span class="hljs-string">"December used to be a month but it is now a year"</span>,
  <span class="hljs-string">"source"</span>: <span class="hljs-string">"Letters from a Stoic"</span>,
  <span class="hljs-string">"author"</span>: <span class="hljs-string">"Seneca"</span>,
  <span class="hljs-string">"year"</span>: <span class="hljs-number">54</span>
}
</code></pre>
<p>We have no guarantees about any of the information here. The server can change the names of fields, and the fields may have different types in different situations. It is a wild world!</p>
<p>In JavaScript, the approach is to just turn JSON into JavaScript objects and hope nothing goes wrong. But if there is some typo or unexpected data, you get a runtime exception somewhere in your code. Was the code wrong? Was the data wrong? It is time to start digging around to find out!</p>
<p>In Elm, we validate the JSON before it comes into our program. So if the data has an unexpected structure, we learn about it immediately. There is no way for bad data to sneak through and cause a runtime exception three files over. This is accomplished with JSON decoders.</p>
<h2 id="json-decoders">JSON Decoders</h2>
<p>Say we have some JSON:</p>
<pre><code class="lang-json">{
  <span class="hljs-string">"name"</span>: <span class="hljs-string">"Tom"</span>,
  <span class="hljs-string">"age"</span>: <span class="hljs-number">42</span>
}
</code></pre>
<p>We need to run it through a <code>Decoder</code> to access specific information. So if we wanted to get the <code>"age"</code>, we would run the JSON through a <code>Decoder Int</code> that describes exactly how to access that information:</p>
<p><img src="diagrams/int.svg" alt=""></img></p>
<p>If all goes well, we get an <code>Int</code> on the other side! And if we wanted the <code>"name"</code> we would run the JSON through a <code>Decoder String</code> that describes exactly how to access it:</p>
<p><img src="diagrams/string.svg" alt=""></img></p>
<p>If all goes well, we get a <code>String</code> on the other side!</p>
<p>How do we create decoders like this though?</p>
<h2 id="building-blocks">Building Blocks</h2>
<p>The <a href="https://package.elm-lang.org/packages/elm/json/latest/" target="_blank"><code>elm/json</code></a> package gives us the <a href="https://package.elm-lang.org/packages/elm/json/latest/Json-Decode" target="_blank"><code>Json.Decode</code></a> module. It is filled with tiny decoders that we can snap together.</p>
<p>So to get <code>"age"</code> from <code>{ "name": "Tom", "age": 42 }</code> we would create a decoder like this:</p>
<pre><code class="lang-elm"><span class="hljs-keyword">import</span> Json.Decode <span class="hljs-keyword">exposing</span> (<span class="hljs-type">Decoder</span>, field, int)


<span class="hljs-title">ageDecoder</span> : <span class="hljs-type">Decoder</span> <span class="hljs-type">Int</span>
<span class="hljs-title">ageDecoder</span> =
    field <span class="hljs-string">"age"</span> int



<span class="hljs-comment">-- int : Decoder Int</span>
<span class="hljs-comment">-- field : String -&gt; Decoder a -&gt; Decoder a</span>
</code></pre>
<p>The <a href="https://package.elm-lang.org/packages/elm/json/latest/Json-Decode#field" target="_blank"><code>field</code></a> function takes two arguments:</p>
<ol>
<li><code>String</code> — a field name. So we are demanding an object with an <code>"age"</code> field.</li>
<li><code>Decoder a</code> — a decoder to try next. So if the <code>"age"</code> field exists, we will try this decoder on the value there.</li>
</ol>
<p>So putting it together, <code>field "age" int</code> is asking for an <code>"age"</code> field, and if it exists, it runs the <code>Decoder Int</code> to try to extract an integer.</p>
<p>We do pretty much exactly the same thing to extract the <code>"name"</code> field:</p>
<pre><code class="lang-elm"><span class="hljs-keyword">import</span> Json.Decode <span class="hljs-keyword">exposing</span> (<span class="hljs-type">Decoder</span>, field, string)


<span class="hljs-title">nameDecoder</span> : <span class="hljs-type">Decoder</span> <span class="hljs-type">String</span>
<span class="hljs-title">nameDecoder</span> =
    field <span class="hljs-string">"name"</span> string



<span class="hljs-comment">-- string : Decoder String</span>
</code></pre>
<p>In this case we demand an object with a <code>"name"</code> field, and if it exists, we want the value there to be a <code>String</code>.</p>
<h2 id="combining-decoders">Combining Decoders</h2>
<p>But what if we want to decode <em>two</em> fields? We snap decoders together with <a href="https://package.elm-lang.org/packages/elm/json/latest/Json-Decode#map2" target="_blank"><code>map2</code></a>:</p>
<pre><code class="lang-elm"><span class="hljs-title">map2</span> : (a -&gt; b -&gt; value) -&gt; <span class="hljs-type">Decoder</span> a -&gt; <span class="hljs-type">Decoder</span> b -&gt; <span class="hljs-type">Decoder</span> value
</code></pre>
<p>This function takes in two decoders. It tries them both and combines their results. So now we can put together two different decoders:</p>
<pre><code class="lang-elm"><span class="hljs-keyword">import</span> Json.Decode <span class="hljs-keyword">exposing</span> (<span class="hljs-type">Decoder</span>, map2, field, string, int)

<span class="hljs-keyword">type</span> <span class="hljs-keyword">alias</span> <span class="hljs-type">Person</span> =
  { name : <span class="hljs-type">String</span>
  , age : <span class="hljs-type">Int</span>
  }

<span class="hljs-title">personDecoder</span> : <span class="hljs-type">Decoder</span> <span class="hljs-type">Person</span>
<span class="hljs-title">personDecoder</span> =
  map2 <span class="hljs-type">Person</span>
      (field <span class="hljs-string">"name"</span> string)
      (field <span class="hljs-string">"age"</span> int)
</code></pre>
<p>So if we used <code>personDecoder</code> on <code>{ "name": "Tom", "age": 42 }</code> we would get out an Elm value like <code>Person "Tom" 42</code>.</p>
<p>If we really wanted to get into the spirit of decoders, we would define <code>personDecoder</code> as <code>map2 Person nameDecoder ageDecoder</code> using our previous definitions. You always want to be building your decoders up from smaller building blocks!</p>
<h2 id="nesting-decoders">Nesting Decoders</h2>
<p>A lot of JSON data is not so nice and flat. Imagine if <code>/api/random-quotes/v2</code> was released with richer information about authors:</p>
<pre><code class="lang-json">{
  <span class="hljs-string">"quote"</span>: <span class="hljs-string">"December used to be a month but it is now a year"</span>,
  <span class="hljs-string">"source"</span>: <span class="hljs-string">"Letters from a Stoic"</span>,
  <span class="hljs-string">"author"</span>: {
    <span class="hljs-string">"name"</span>: <span class="hljs-string">"Seneca"</span>,
    <span class="hljs-string">"age"</span>: <span class="hljs-number">68</span>,
    <span class="hljs-string">"origin"</span>: <span class="hljs-string">"Cordoba"</span>
  },
  <span class="hljs-string">"year"</span>: <span class="hljs-number">54</span>
}
</code></pre>
<p>We could handle this new scenario by nesting our nice little decoders:</p>
<pre><code class="lang-elm"><span class="hljs-keyword">import</span> Json.Decode <span class="hljs-keyword">exposing</span> (<span class="hljs-type">Decoder</span>, field, int, map2, map4, string)


<span class="hljs-keyword">type</span> <span class="hljs-keyword">alias</span> <span class="hljs-type">Quote</span> =
    { quote : <span class="hljs-type">String</span>
    , source : <span class="hljs-type">String</span>
    , author : <span class="hljs-type">Person</span>
    , year : <span class="hljs-type">Int</span>
    }


<span class="hljs-title">quoteDecoder</span> : <span class="hljs-type">Decoder</span> <span class="hljs-type">Quote</span>
<span class="hljs-title">quoteDecoder</span> =
    map4 <span class="hljs-type">Quote</span>
        (field <span class="hljs-string">"quote"</span> string)
        (field <span class="hljs-string">"source"</span> string)
        (field <span class="hljs-string">"author"</span> personDecoder)
        (field <span class="hljs-string">"year"</span> int)


<span class="hljs-keyword">type</span> <span class="hljs-keyword">alias</span> <span class="hljs-type">Person</span> =
    { name : <span class="hljs-type">String</span>
    , age : <span class="hljs-type">Int</span>
    }


<span class="hljs-title">personDecoder</span> : <span class="hljs-type">Decoder</span> <span class="hljs-type">Person</span>
<span class="hljs-title">personDecoder</span> =
    map2 <span class="hljs-type">Person</span>
        (field <span class="hljs-string">"name"</span> string)
        (field <span class="hljs-string">"age"</span> int)
</code></pre>
<p>Notice that we do not bother decoding the <code>"origin"</code> field of the author. Decoders are fine with skipping over fields, which can be helpful when extracting a small amount of information from very large JSON values.</p>
<h2 id="next-steps">Next Steps</h2>
<p>There are a bunch of important functions in <code>Json.Decode</code> that we did not cover here:</p>
<ul>
<li><a href="https://package.elm-lang.org/packages/elm/json/latest/Json-Decode#bool" target="_blank"><code>bool</code></a> : <code>Decoder Bool</code></li>
<li><a href="https://package.elm-lang.org/packages/elm/json/latest/Json-Decode#list" target="_blank"><code>list</code></a> : <code>Decoder a -&gt; Decoder (List a)</code></li>
<li><a href="https://package.elm-lang.org/packages/elm/json/latest/Json-Decode#dict" target="_blank"><code>dict</code></a> : <code>Decoder a -&gt; Decoder (Dict String a)</code></li>
<li><a href="https://package.elm-lang.org/packages/elm/json/latest/Json-Decode#oneOf" target="_blank"><code>oneOf</code></a> : <code>List (Decoder a) -&gt; Decoder a</code></li>
</ul>
<p>So there are ways to extract all sorts of data structures. The <code>oneOf</code> function is particularly helpful for messy JSON. (e.g. sometimes you get an <code>Int</code> and other times you get a <code>String</code> containing digits. So annoying!)</p>
<p>We saw <a href="https://package.elm-lang.org/packages/elm/json/latest/Json-Decode#map2" target="_blank"><code>map2</code></a> and <a href="https://package.elm-lang.org/packages/elm/json/latest/Json-Decode#map4" target="_blank"><code>map4</code></a> for handling objects with many fields. But as you start working with larger and larger JSON objects, it is worth checking out <a href="https://package.elm-lang.org/packages/NoRedInk/elm-json-decode-pipeline/latest" target="_blank"><code>NoRedInk/elm-json-decode-pipeline</code></a>. The types there are a bit fancier, but some folks find them much easier to read and work with.</p>
<blockquote>
<p><strong>Fun Fact:</strong> I have heard a bunch of stories of folks finding bugs in their <em>server</em> code as they switched from JS to Elm. The decoders people write end up working as a validation phase, catching weird stuff in JSON values. So when NoRedInk switched from React to Elm, it revealed a couple bugs in their Ruby code!</p>
</blockquote>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="http.html" class="navigation navigation-prev " aria-label="Previous page: HTTP">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="random.html" class="navigation navigation-next " aria-label="Next page: Random">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"JSON","level":"1.6.2","depth":2,"next":{"title":"Random","level":"1.6.3","depth":2,"path":"effects/random.md","ref":"effects/random.md","articles":[]},"previous":{"title":"HTTP","level":"1.6.1","depth":2,"path":"effects/http.md","ref":"effects/http.md","articles":[]},"dir":"ltr"},"config":{"plugins":["youtube","elm-repl","bulk-redirect","-sharing"],"root":"book","styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"bulk-redirect":{"basepath":"/","redirectsFile":"redirects.json"},"youtube":{},"elm-repl":{},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","author":"Evan Czaplicki","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56},"embedFonts":false},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"Introducción a Elm","gitbook":"*","description":"Aprende Elm. Construye aplicaciones. Aprende programación funcional."},"file":{"path":"effects/json.md","mtime":"2024-08-25T17:05:37.764Z","type":"markdown"},"gitbook":{"version":"5.1.4","time":"2024-09-05T20:25:02.284Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <noscript>
        <style>
            .honkit-cloak {
                display: block !important;
            }
        </style>
    </noscript>
    <script>
        // Restore sidebar state as critical path for prevent layout shift
        function __init__getSidebarState(defaultValue){
            var baseKey = "";
            var key = baseKey + ":sidebar";
            try {
                var value = localStorage[key];
                if (value === undefined) {
                    return defaultValue;
                }
                var parsed = JSON.parse(value);
                return parsed == null ? defaultValue : parsed;
            } catch (e) {
                return defaultValue;
            }
        }
        function __init__restoreLastSidebarState() {
            var isMobile = window.matchMedia("(max-width: 600px)").matches;
            if (isMobile) {
                // Init last state if not mobile
                return;
            }
            var sidebarState = __init__getSidebarState(true);
            var book = document.querySelector(".book");
            // Show sidebar if it enabled
            if (sidebarState && book) {
                book.classList.add("without-animation", "with-summary");
            }
        }

        try {
            __init__restoreLastSidebarState();
        } finally {
            var book = document.querySelector(".book");
            book.classList.remove("honkit-cloak");
        }
    </script>
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-elm-repl/repl.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

